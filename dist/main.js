(()=>{"use strict";class e{constructor(e,t){this._config=e,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._errorClass=e.errorClass,this._buttonSelector=e.buttonSelector,this._buttonDisabledClass=e.buttonDisabledClass,this._form=t,this._buttonSubmit=this._form.querySelector(this._buttonSelector),this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector))}_disableSubmit(e){e.preventDefault()}_handleFormInput(e){this._input=e.target,this._inputId=this._input.id,this._errorElement=document.querySelector(`#${this._inputId}-error`),this._input.validity.valid?(this._input.classList.remove(this._errorClass),this._errorElement.textContent=""):(this._input.classList.add(this._errorClass),this._errorElement.textContent=this._input.validationMessage)}toggleButton(){this._isFormValid=this._form.checkValidity(),this._buttonSubmit.disabled=!this._isFormValid,this._buttonSubmit.classList.toggle(this._buttonDisabledClass,!this._isFormValid)}_addInputListnener(){this._inputList.forEach((e=>{e.addEventListener("input",(e=>{this._handleFormInput(e)}))}))}enableValidation(){this._form.addEventListener("submit",this._disableSubmit),this._form.addEventListener("input",(()=>{this.toggleButton()})),this._addInputListnener(),this.toggleButton()}}class t{constructor(e,t,n,r){this._name=e,this._link=t,this._openBigPopup=n,this._templateSelector=r}_getTemplate(){return this._card=this._templateSelector.content.querySelector(".card").cloneNode(!0),this._card}createNewCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._deletBtn=this._element.querySelector(".card__trash-button"),this._likeBtn=this._element.querySelector(".card__like-button"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._element}_deleteCard(){this._element.remove()}_toggleLike(){this._likeBtn.classList.toggle("card__like-button_active")}_setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._openBigPopup(this._name,this._link)})),this._deletBtn.addEventListener("click",(()=>{this._deleteCard()})),this._likeBtn.addEventListener("click",(()=>{this._toggleLike()}))}}const n=document.forms["popup-edit-form"],r=document.forms["popup-adding-cards-form"],o=document.querySelector(".popup_user_info"),s=document.querySelector(".popup_type_cards"),i=document.querySelector(".popup_type_image"),l=document.querySelectorAll(".popup__close-button"),a=document.querySelector(".profile__edit-button"),u=document.querySelector(".profile__add-button"),c=o.querySelector("#name-input"),d=o.querySelector("#about-input"),p=document.querySelector(".profile__title"),_=document.querySelector(".profile__subtitle"),m=document.querySelector(".template-cards"),h=document.querySelector("#place-input"),g=document.querySelector("#url-input"),y=document.querySelector(".popup__image"),b=document.querySelector(".popup__figcaption"),v=document.querySelectorAll(".popup"),S=(o.querySelector(".popup__save-buttom"),s.querySelector("#save-card-button"),document.querySelector(".cards__list")),f={formSelector:".popup__input-list",inputSelector:".popup__input",errorClass:"popup__input_type-error",buttonSelector:".popup__save-buttom",buttonDisabledClass:"popup__save-button_disabled"};function k(e){return new t(e.name,e.link,E,m).createNewCard()}[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((e=>{const t=k(e);S.append(t)})),r.addEventListener("submit",(function(e){e.preventDefault(),S.prepend(k({name:h.value,link:g.value})),x(s)}));const L=new e(f,r);L.enableValidation(),L.toggleButton();const q=new e(f,n);function E(e,t){C(i),y.src=t,b.textContent=e,y.alt=e}function C(e){e.classList.add("popup_opened"),document.addEventListener("keydown",B)}q.enableValidation(),q.toggleButton(),a.addEventListener("click",(()=>{C(o),c.value=p.textContent,d.value=_.textContent})),u.addEventListener("click",(()=>{r.reset(),C(s),L.toggleButton()}));const x=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",B)};function B(e){"Escape"===e.key&&v.forEach(x)}l.forEach((e=>{e.addEventListener("click",(e=>{x(e.target.closest(".popup"))}))})),v.forEach((e=>{e.addEventListener("click",(t=>{t.target===t.currentTarget&&x(e)}))})),n.addEventListener("submit",(function(e){e.preventDefault(),p.textContent=c.value,_.textContent=d.value,x(o)}))})();